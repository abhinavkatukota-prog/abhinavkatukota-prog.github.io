<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flappy Bird Clone</title>
  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <!-- Load woof.js -->
  <script src="https://rawgit.com/stevekrouse/WoofJS/master/woof.js"></script>

  <script>
    // --- Your Game Code ---
    setBackdropURL("./docs/images/flappyback.png")
    setBackdropStyle("cover")

    forever(() => {
      if (bird.y < minY) {
        freeze()
        new Text({
          text: () => "Game Over", 
          size: 200, 
          color: "rgb(100, 50, 240)", 
          fontFamily: "arial", 
          textAlign: "center"
        })
      }
    })

    var score = 0
    var froggyscoe = new Text({
      text: () => "score: " + score, 
      size: 20, 
      color: "rgb(100, 50, 240)", 
      fontFamily: "arial", 
      textAlign: "left",
      x: minX + 10,
      y: maxY - 50,
    })

    var bird = new Image({
      url: "./docs/images/bird.png",
      width: 60, 
      height: 50,
    })

    var pipes = []
    every(1, 'second', () => {
      var bottomPipe = new Image({
        url: "./docs/images/bottomPipe.png",
        width: 100, 
        height: 500,
        y: random(-400, -200),
        x: maxX
      })

      var topPipe = new Image({
        url: "./docs/images/topPipe.png",
        width: 100, 
        height: 500,
        y: bottomPipe.y + 699,        
        x: maxX
      })

      pipes.push(bottomPipe)
      pipes.push(topPipe)
    })

    var gravity = -0.3
    var speed = 0

    forever(() => {
      bird.y += speed
      speed += gravity
      if (speed < -12) speed = -12
      if (keysDown.includes('UP')) {
        speed = 2
      }
    })

    forever(() => {
      pipes.forEach(pipe => {
        pipe.x -= 4
        if (bird.touching(pipe)) {
          freeze()
          new Text({
            text: () => "Game Over", 
            size: 50, 
            color: "rgb(100, 50, 240)", 
            fontFamily: "arial", 
            textAlign: "center"
          })
        }
        if (pipe.x < bird.x && pipe.x > bird.x - 5) {
          score += 0.5
        }
        if (pipe.x < minX) {
          pipe.delete()
          pipes.remove(pipe)
        }
      })
    })
  </script>
</body>
</html>
